/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
'use strict';import _0x8169ab from'./../../../messagescompressor';import _0x4481f3 from'./../../../message';import PacketOptionsMessage from'./packetoptionsmessage';import NumberBytesPacketDataMessage from'./numberbytespacketdatamessage';import StringBytesPacketDataMessage from'./stringbytespacketdatamessage';import BytesBytesPacketDataMessage from'./bytesbytespacketdatamessage';import StringObjectPacketDataMessage from'./stringobjectpacketdatamessage';import NumberObjectPacketDataMessage from'./numberobjectpacketdatamessage';import ObjectObjectPacketDataMessage from'./objectobjectpacketdatamessage';import ObjectBufferPacketDataMessage from'./objectbufferpacketdatamessage';import StringStringPacketDataMessage from'./stringstringpacketdatamessage';import StringNumberPacketDataMessage from'./stringnumberpacketdatamessage';import NumberNumberPacketDataMessage from'./numbernumberpacketdatamessag';import NumberStringPacketDataMessage from'./numberstringpacketdatamessag';const PACKET_DATA_MESSAGES=[NumberBytesPacketDataMessage,StringBytesPacketDataMessage,BytesBytesPacketDataMessage,StringObjectPacketDataMessage,NumberObjectPacketDataMessage,ObjectObjectPacketDataMessage,ObjectBufferPacketDataMessage,StringStringPacketDataMessage,StringNumberPacketDataMessage,NumberNumberPacketDataMessage,NumberStringPacketDataMessage]['reduce']((result,PacketDataMessage)=>(result[PacketDataMessage['TYPE']]=PacketDataMessage,result),{});import ParserUtils from'./../parserutils';export default class PacketMessage extends _0x4481f3{constructor(type,data,_0x1f5e08,_0x1b2e27,options){super(),this['type']=type,this['id']=_0x1f5e08,this['nsp']=_0x1b2e27||'/',this['data']=data,this['options']=options;}get['packetData'](){return[this['data']['data'],this['data']['data1']];}['toJSON'](){const options=_0x8169ab['encode'](this['options']),data=_0x8169ab['encode'](this['data']);return{'type':this['type']+0xa*this['data']['constructor']['TYPE'],'id':this['id'],'nsp':'/'===this['nsp']?void 0x0:this['nsp'],'data':data['length']?data:void 0x0,'options':options['length']?options:void 0x0};}static get['TYPE'](){return 0xa;}static get['DESCRIPTOR_NAME'](){return'PacketMessage';}static get['DESCRIPTOR'](){return{'fields':{'type':{'type':'uint32','id':0x1},'id':{'type':'uint32','id':0x2},'nsp':{'type':'string','id':0x3},'data':{'type':'bytes','id':0x4},'options':{'type':'bytes','id':0x5}}};}static['fromJSON'](data){const frameDataType=Math['floor'](data['type']/0xa);return new PacketMessage(data['type']-0xa*frameDataType,_0x8169ab['decode'](data['data'],PACKET_DATA_MESSAGES[frameDataType]),data['id'],data['nsp'],_0x8169ab['decode'](data['options'],PacketOptionsMessage));}static['create'](packet,options={}){const frameDataType=ParserUtils['getPacketType'](ParserUtils['getTypeName'](packet['data'][0x0]),ParserUtils['getTypeName'](packet['data'][0x1]));return new PacketMessage(packet['type'],PACKET_DATA_MESSAGES[frameDataType]['create'](packet['data'][0x0],packet['data'][0x1]),packet['id'],packet['nsp'],new PacketOptionsMessage(options['flags'],options['rooms'],options['except']));}}