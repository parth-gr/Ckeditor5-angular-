/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x366855 from'@ckeditor/ckeditor5-core/src/contextplugin';import _0xe10bd7 from'@ckeditor/ckeditor5-utils/src/collection';import'../theme/usercolors.css';import _0x55678d from'@ckeditor/ckeditor5-utils/src/ckeditorerror';export default class r extends _0x366855{static get['pluginName'](){return'Users';}constructor(_0x5c8a2e){super(_0x5c8a2e),_0x5c8a2e['config']['define']('users.anonymousUserId','anonymous-user'),_0x5c8a2e['config']['define']('users.colorsCount',0x8),this['users']=new _0xe10bd7(),this['s']=_0x5c8a2e['locale'],this['i']=null,this['o']=0x0,this['l']=null,this['decorate']('getOperationAuthor');}['init'](){const _0x3f009d=this['context'];this['licenseKey']=_0x3f009d['config']['get']('licenseKey'),this['i']=setInterval(()=>{let _0x15a36b;for(const _0x2d937b in _0x3f009d){const _0x19e7c8=_0x3f009d[_0x2d937b];if('licenseKeyTrial'===_0x19e7c8||'licenseKeyInvalid'===_0x19e7c8||'licenseKeyValid'===_0x19e7c8||'licenseKeyTrialLimit'==_0x19e7c8){delete _0x3f009d[_0x2d937b],_0x15a36b=_0x19e7c8;break;}}if('licenseKeyInvalid'===_0x15a36b)throw clearInterval(this['i']),new _0x55678d('invalid-license-key:\x20Invalid\x20license\x20key.\x20Please\x20contact\x20our\x20customer\x20support\x20at\x20https://ckeditor.com/contact/.',null);if('licenseKeyTrial'===_0x15a36b&&console['info']('You\x20are\x20using\x20the\x20trial\x20version\x20of\x20CKEditor\x205\x20collaboration\x20plugin\x20with\x20limited\x20usage.\x20Make\x20sure\x20you\x20will\x20not\x20use\x20it\x20in\x20the\x20production\x20environment.'),'licenseKeyTrialLimit'===_0x15a36b)throw clearInterval(this['i']),new _0x55678d('trial-license-key-reached-limit:\x20You\x20have\x20exhausted\x20the\x20trial\x20usage\x20limit.\x20You\x20need\x20to\x20restart\x20the\x20editor\x20now.\x20Please\x20contact\x20our\x20customer\x20support\x20to\x20get\x20a\x20full\x20access\x20at\x20https://ckeditor.com/contact/.',null);'licenseKeyValid'===_0x15a36b&&clearInterval(this['i']);},0x3e8);}get['me'](){return null==this['l']?null:this['getUser'](this['l']);}['addUser'](_0x1f0b24){if(!(_0x1f0b24=Object['assign']({},_0x1f0b24,{'color':this['u']()}))['id']||'string'!=typeof _0x1f0b24['id'])throw new _0x55678d('users-add-invalid-id:\x20The\x20id\x20must\x20be\x20a\x20string.');if(this['users']['has'](_0x1f0b24['id']))throw new _0x55678d('users-add-duplicated-id:\x20User\x20with\x20a\x20given\x20id\x20is\x20already\x20added.',null,{'id':_0x1f0b24['id']});_0x1f0b24['name']=function(_0x9bb81,_0x3f53ae=''){const {t:t}=_0x9bb81;return''==(_0x3f53ae=_0x3f53ae['trim']())?t('Anonymous'):_0x3f53ae;}(this['s'],_0x1f0b24['name']);const _0x43626b=new n(_0x1f0b24);return this['users']['add'](_0x43626b),_0x43626b;}['getUser'](_0x193386){return this['users']['get'](_0x193386);}['useAnonymousUser'](){const _0x246f7c=this['context']['config']['get']('users.anonymousUserId'),{t:t}=this['s'];this['users']['has'](_0x246f7c)||(this['addUser']({'id':_0x246f7c,'name':t('Anonymous')})['_isAnonymous']=!0x0,this['defineMe'](_0x246f7c));}['defineMe'](_0x313e1f){if(this['l'])throw new _0x55678d('users-me-already-defined:\x20Cannot\x20add\x20a\x20local\x20user\x20more\x20than\x20once.',null);if(!this['getUser'](_0x313e1f))throw new _0x55678d('users-me-missing-user:\x20Cannot\x20add\x20an\x20undefined\x20user\x20as\x20a\x20local\x20user.',null);this['l']=_0x313e1f;}['getOperationAuthor'](){return this['me'];}['destroy'](){super['destroy'](),clearInterval(this['i']);}['u'](){const _0x264f68=this['context']['config']['get']('users.colorsCount');return this['o']>=_0x264f68&&(this['o']=0x0),new o(this['o']++);}}class n{constructor(_0x3332cc){this['id']=_0x3332cc['id'],this['color']=_0x3332cc['color'],this['name']=_0x3332cc['name'],this['avatar']=_0x3332cc['avatar'],this['_isAnonymous']=!0x1;}get['isAnonymous'](){return this['_isAnonymous'];}get['initials'](){return this['name']['split']('\x20')['map'](_0x85bce9=>_0x85bce9['charAt'](0x0))['slice'](0x0,0x2)['join']('')['toUpperCase']();}}class o{constructor(_0x4d8bfc){this['h']=_0x4d8bfc;}['getBackgroundColorClass'](){return'ck-user__bg-color--'+this['h'];}['getSelectionClass'](){return'ck-user__selection--'+this['h'];}['getMarkerClass'](){return'ck-user__marker--'+this['h'];}}