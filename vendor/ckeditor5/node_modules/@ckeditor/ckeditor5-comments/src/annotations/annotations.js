/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x53ce=['delete','locale','selectedViews','pluginName','register','get','uiType','annotations-register-already-registered:\x20UI\x20of\x20a\x20given\x20name\x20already\x20registered.','length','element','has','fire','remove','destroy','detach','change:activeView','function','targetRect','_throttledOrderUpdate','cancel','sort','add','switchTo','context','Annotations','resize','activeView','max','attach','items','getTarget','isActive','customView','annotations-duplicated-item:\x20Given\x20view\x20was\x20already\x20added\x20to\x20the\x20annotations\x20repository.','addEventListener','from','annotations-register-invalid-interface:\x20UI\x20plugin\x20must\x20implement\x20#attach\x20and\x20#detach\x20methods.','left','focusTracker','top','change:isFocused','set','init'];(function(_0x495cfa,_0x311ac5){const _0x3b24da=function(_0x2d93a7){while(--_0x2d93a7){_0x495cfa['push'](_0x495cfa['shift']());}};_0x3b24da(++_0x311ac5);}(_0x53ce,0x1ae));const _0x18a2=function(_0x495cfa,_0x311ac5){_0x495cfa=_0x495cfa-0x0;let _0x3b24da=_0x53ce[_0x495cfa];return _0x3b24da;};import _0x4caa8a from'@ckeditor/ckeditor5-core/src/contextplugin';import _0x28382a from'../annotations/view/annotationview';import _0x167d41 from'@ckeditor/ckeditor5-utils/src/collection';import _0x5186bc from'@ckeditor/ckeditor5-utils/src/focustracker';import _0x3fd88b from'@ckeditor/ckeditor5-utils/src/dom/rect';import _0x23381b from'@ckeditor/ckeditor5-utils/src/ckeditorerror';import{throttle as _0x518d1d}from'lodash-es';import'../../theme/annotation.css';export default class a extends _0x4caa8a{static get[_0x18a2('0x3')](){return _0x18a2('0x18');}constructor(_0x4a56f1){super(_0x4a56f1),this[_0x18a2('0x1d')]=new _0x167d41(),this[_0x18a2('0x29')](_0x18a2('0x2'),[]),this[_0x18a2('0x29')]('activeView',null),this['on'](_0x18a2('0xf'),(_0x189266,_0x5dffbd,_0x223652,_0x3d04e9)=>{_0x223652&&(this['i']['get'](_0x223652)[_0x18a2('0x1f')]=!0x0);const _0x3c7ee0=this['i'][_0x18a2('0x5')](_0x3d04e9);_0x3d04e9&&_0x3c7ee0&&(_0x3c7ee0[_0x18a2('0x1f')]=!0x1);}),this['focusTracker']=new _0x5186bc(),this[_0x18a2('0x26')]['on'](_0x18a2('0x28'),(_0x3513e7,_0x154820,_0x225bb0)=>{_0x225bb0||(this['activeView']=null);}),this[_0x18a2('0x6')]='',this['s']=new Map(),this['i']=new Map(),this['o']=new Map(),this[_0x18a2('0x12')]=_0x518d1d(()=>{this['h'](),this['u']();},0x190,{'leading':!0x1});}[_0x18a2('0x2a')](){window[_0x18a2('0x22')]('resize',this[_0x18a2('0x12')]);}[_0x18a2('0x4')](_0x2af0cc,_0x30d0a9){if(this['s'][_0x18a2('0xa')](_0x2af0cc))throw new _0x23381b(_0x18a2('0x7'));if('function'!=typeof _0x30d0a9[_0x18a2('0x1c')]||_0x18a2('0x10')!=typeof _0x30d0a9[_0x18a2('0xe')])throw new _0x23381b(_0x18a2('0x24'));this['s'][_0x18a2('0x29')](_0x2af0cc,_0x30d0a9);}[_0x18a2('0x16')](_0x9b6820){if(!this['s']['has'](_0x9b6820))throw new _0x23381b('annotations-switchto-missing-ui:\x20UI\x20of\x20a\x20given\x20name\x20has\x20been\x20not\x20registered.',this);this[_0x18a2('0x6')]!==_0x9b6820&&(this['uiType']&&this['s']['get'](this[_0x18a2('0x6')])[_0x18a2('0xe')](),this['uiType']=_0x9b6820,this['s']['get'](this[_0x18a2('0x6')])['attach']());}[_0x18a2('0x15')](_0x3644d9,_0x1d041c){if(this['i']['has'](_0x3644d9))throw new _0x23381b(_0x18a2('0x21'),this);const _0x290816=new _0x28382a(this[_0x18a2('0x17')][_0x18a2('0x1')],_0x3644d9);_0x290816['render'](),this['focusTracker'][_0x18a2('0x15')](_0x290816[_0x18a2('0x9')]),_0x290816['focusTracker']['on']('change:isFocused',(_0x11894d,_0x594b7a,_0x32d164)=>{_0x32d164&&(this[_0x18a2('0x1a')]=_0x3644d9);}),this['o'][_0x18a2('0x29')](_0x3644d9,_0x1d041c),this['l'](_0x290816);const _0x1d490f=this['m'](_0x290816[_0x18a2('0x11')]);return this[_0x18a2('0x1d')][_0x18a2('0x15')](_0x290816,_0x1d490f),this['i'][_0x18a2('0x29')](_0x3644d9,_0x290816),_0x290816;}[_0x18a2('0xc')](_0x17cc74){if(!this['i'][_0x18a2('0xa')](_0x17cc74))return;const _0x47313c=this['i']['get'](_0x17cc74);this['focusTracker'][_0x18a2('0xc')](_0x47313c['element']),this[_0x18a2('0x1a')]===_0x17cc74&&(this[_0x18a2('0x1a')]=null),this['items']['remove'](_0x47313c),_0x47313c[_0x18a2('0xd')](),this['o'][_0x18a2('0x0')](_0x17cc74),this['i'][_0x18a2('0x0')](_0x17cc74);}['getTarget'](_0x19bc6e){const _0x4413f6=this['o'][_0x18a2('0x5')](_0x19bc6e);return _0x18a2('0x10')==typeof _0x4413f6?_0x4413f6():_0x4413f6;}['getAnnotationView'](_0x3d7c28){return this['i'][_0x18a2('0x5')](_0x3d7c28);}['refresh'](){this[_0x18a2('0xb')]('refresh'),this[_0x18a2('0x12')]();}['destroy'](){super['destroy'](),window['removeEventListener'](_0x18a2('0x19'),this['_throttledOrderUpdate']),this[_0x18a2('0x12')][_0x18a2('0x13')](),this[_0x18a2('0x1d')]['map'](_0x4424cd=>_0x4424cd[_0x18a2('0xd')]());}['h'](){for(const _0x53e5a5 of this[_0x18a2('0x1d')])this['l'](_0x53e5a5);}['l'](_0x3622cf){const _0x30a824=this[_0x18a2('0x1e')](_0x3622cf[_0x18a2('0x20')]);_0x3622cf[_0x18a2('0x11')]=new _0x3fd88b(_0x30a824);}['u'](){const _0x25ab7b=Array[_0x18a2('0x23')](this['items'])[_0x18a2('0x14')]((_0x4e2073,_0x350b3e)=>c(_0x4e2073[_0x18a2('0x11')],_0x350b3e['targetRect']));for(let _0x2e9e0c=_0x25ab7b[_0x18a2('0x8')]-0x1;_0x2e9e0c>0x0;_0x2e9e0c--){const _0x31d1d0=_0x25ab7b[_0x2e9e0c];_0x2e9e0c!==this[_0x18a2('0x1d')]['getIndex'](_0x31d1d0)&&(this[_0x18a2('0x1d')][_0x18a2('0xc')](_0x31d1d0),this[_0x18a2('0x1d')]['add'](_0x31d1d0,_0x2e9e0c));}}['m'](_0x49da24){let _0x1e7b22=0x0;for(const _0x228a31 of this[_0x18a2('0x1d')]){const _0x1c0279=this[_0x18a2('0x1e')](_0x228a31[_0x18a2('0x20')]);if(c(_0x49da24,new _0x3fd88b(_0x1c0279))<0x0)return _0x1e7b22;_0x1e7b22++;}return Math[_0x18a2('0x1b')](0x0,_0x1e7b22);}}function c(_0x5476c5,_0x29ac0e){const _0x4c692f=_0x5476c5[_0x18a2('0x27')]-_0x29ac0e[_0x18a2('0x27')];return 0x0==_0x4c692f?_0x5476c5['left']-_0x29ac0e[_0x18a2('0x25')]:_0x4c692f;}