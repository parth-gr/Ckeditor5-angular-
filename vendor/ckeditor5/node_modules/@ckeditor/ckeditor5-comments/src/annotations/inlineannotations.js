/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3b6c=['visibleView','keystrokes','afterInit','change:height','destroy','items','pluginName','switchTo','inlineannotations-attach-already-attached:\x20Cannot\x20attach\x20the\x20same\x20annotation\x20twice.','focusTracker','focus','Esc','context','remove','targetRect','stopListening','change:visibleView','getAnnotationView','mousedown','inlineannotations-not-allowed-with-context:\x20Cannot\x20switch\x20Annotations\x20UI\x20to\x20`InlineAnnotations`\x20when\x20using\x20`Context`.','Annotations','editor','requires','isFocused','change:isFocused','editing','document','plugins','get','showStack','listenTo','delete','customView','inlineannotations-detach-not-attached:\x20Cannot\x20detach\x20a\x20UI\x20if\x20it\x20is\x20not\x20attached.','hasView','inline','activeView','view','clear','add','update','includes','set','refresh','detach','has','isAttached','getTarget'];(function(_0x5a19f2,_0x14e84c){const _0x17b4c7=function(_0x59fce7){while(--_0x59fce7){_0x5a19f2['push'](_0x5a19f2['shift']());}};_0x17b4c7(++_0x14e84c);}(_0x3b6c,0xdd));const _0x376c=function(_0x5a19f2,_0x14e84c){_0x5a19f2=_0x5a19f2-0x0;let _0x17b4c7=_0x3b6c[_0x5a19f2];return _0x17b4c7;};import _0x51c436 from'@ckeditor/ckeditor5-core/src/plugin';import _0x2f1f0b from'../annotations/annotations';import _0x29be3f from'./editorannotations';import _0x330265 from'@ckeditor/ckeditor5-ui/src/panel/balloon/contextualballoon';import _0x28a4c0 from'@ckeditor/ckeditor5-engine/src/view/observer/mouseobserver';import _0x25116f from'@ckeditor/ckeditor5-utils/src/ckeditorerror';import'./../../theme/annotation-inline.css';export default class f extends _0x51c436{static get[_0x376c('0x29')](){return[_0x2f1f0b,_0x29be3f,_0x330265];}static get[_0x376c('0x19')](){return'InlineAnnotations';}constructor(_0x5ba5c8){super(_0x5ba5c8),_0x5ba5c8['editing'][_0x376c('0x8')]['addObserver'](_0x28a4c0),this[_0x376c('0x11')]=!0x1,this['v']=new Set(),this['A']=_0x5ba5c8['plugins'][_0x376c('0x2f')](_0x330265),this['I']=new Set();}['init'](){const _0x231811=this[_0x376c('0x28')][_0x376c('0x2e')]['get'](_0x2f1f0b);_0x231811[_0x376c('0x1f')]===this[_0x376c('0x28')]&&(_0x231811['register'](_0x376c('0x6'),this),this['editor'][_0x376c('0x14')][_0x376c('0xd')](_0x376c('0x1e'),(_0x392d8a,_0x35a18d)=>{const _0x5bdd9e=this['A'];this[_0x376c('0x11')]&&_0x5bdd9e[_0x376c('0x13')]&&_0x231811['items']['has'](_0x5bdd9e[_0x376c('0x13')])&&(this['v'][_0x376c('0xa')](_0x5bdd9e[_0x376c('0x13')]),this['C'](_0x5bdd9e['visibleView']),_0x35a18d());}));}[_0x376c('0x15')](){const _0x4a4b6b=this[_0x376c('0x28')][_0x376c('0x2e')][_0x376c('0x2f')](_0x2f1f0b);_0x4a4b6b['context']===this[_0x376c('0x28')]&&(_0x4a4b6b['uiType']||_0x4a4b6b[_0x376c('0x1a')](_0x376c('0x6')));}[_0x376c('0x17')](){this[_0x376c('0x11')]&&this[_0x376c('0xf')]();}['attach'](){const _0x374698=this[_0x376c('0x28')][_0x376c('0x2e')][_0x376c('0x2f')](_0x376c('0x27')),_0x3ef795=this['A'];if(this[_0x376c('0x11')])throw new _0x25116f(_0x376c('0x1b'),this);if(_0x374698[_0x376c('0x1f')]!==this['editor'])throw new _0x25116f(_0x376c('0x26'),this);this['listenTo'](this[_0x376c('0x28')]['ui']['focusTracker'],_0x376c('0x2b'),(_0x2a21d0,_0x5ad073,_0x99b79e)=>{if(!_0x99b79e)for(const _0x1a2db2 of _0x374698[_0x376c('0x18')])this['C'](_0x1a2db2);}),this[_0x376c('0x1')](_0x374698['items'],_0x376c('0x20'),(_0x5e9552,_0xa9ea2c)=>{this['C'](_0xa9ea2c);}),this['listenTo'](_0x374698,'change:selectedViews',(_0xd21917,_0x369c23,_0x41cb8c,_0x19f050)=>{for(const _0x56a2e8 of _0x19f050)_0x41cb8c[_0x376c('0xc')](_0x56a2e8)||this['v'][_0x376c('0x2')](_0x374698[_0x376c('0x24')](_0x56a2e8));for(const _0x17bbae of _0x374698['items'])_0x41cb8c[_0x376c('0xc')](_0x17bbae[_0x376c('0x3')])||this['C'](_0x17bbae);if(this[_0x376c('0x28')]['ui']['focusTracker'][_0x376c('0x2a')])for(const _0x53dc01 of _0x41cb8c)this['V'](_0x374698['getAnnotationView'](_0x53dc01));}),this['listenTo'](_0x374698,'change:activeView',(_0x464bef,_0x79785,_0x237e42)=>{_0x237e42&&this[_0x376c('0x28')]['ui'][_0x376c('0x1c')]['isFocused']&&this['V'](_0x374698[_0x376c('0x24')](_0x237e42),!0x0);}),this['listenTo'](_0x3ef795,_0x376c('0x23'),(_0x39db05,_0x262be0,_0x3fd68d,_0x35e54b)=>{_0x35e54b&&this[_0x376c('0x22')](_0x35e54b),_0x3fd68d&&_0x374698['items']['has'](_0x3fd68d)&&(this[_0x376c('0x1')](_0x3fd68d,_0x376c('0x16'),()=>_0x3ef795['updatePosition']()),this[_0x376c('0x1')](_0x3fd68d,_0x376c('0x1e'),()=>{this['v'][_0x376c('0xa')](_0x3fd68d),this['C'](_0x3fd68d),this['editor'][_0x376c('0x2c')][_0x376c('0x8')][_0x376c('0x1d')]();}),_0x374698['activeView']!==_0x3fd68d[_0x376c('0x3')]&&(_0x374698[_0x376c('0x7')]=_0x3fd68d[_0x376c('0x3')]));}),this['listenTo'](this['editor']['ui'],_0x376c('0xb'),()=>{_0x3ef795[_0x376c('0x13')]&&_0x374698['items'][_0x376c('0x10')](_0x3ef795[_0x376c('0x13')])&&_0x3ef795['updatePosition']();}),this[_0x376c('0x1')](this[_0x376c('0x28')][_0x376c('0x2c')][_0x376c('0x8')][_0x376c('0x2d')],_0x376c('0x25'),()=>{this['v'][_0x376c('0x9')](),_0x374698[_0x376c('0xe')]();}),this[_0x376c('0x11')]=!0x0;}[_0x376c('0xf')](){if(!this['isAttached'])throw new _0x25116f(_0x376c('0x4'),this);const _0x262168=this[_0x376c('0x28')]['plugins'][_0x376c('0x2f')](_0x376c('0x27')),_0x13a9a1=this['A'];for(const _0x5ae3cb of this['I'])this['C'](_0x5ae3cb);this[_0x376c('0x22')](_0x262168['items']),this[_0x376c('0x22')](_0x262168),this[_0x376c('0x22')](_0x13a9a1),this[_0x376c('0x22')](this[_0x376c('0x28')]['ui']),this[_0x376c('0x22')](this[_0x376c('0x28')]['ui']['focusTracker']),this[_0x376c('0x22')](this[_0x376c('0x28')][_0x376c('0x2c')][_0x376c('0x8')][_0x376c('0x2d')]),this[_0x376c('0x11')]=!0x1;}['V'](_0x4cfc61,_0x4498bb){const _0x548354=this['editor'][_0x376c('0x2e')][_0x376c('0x2f')](_0x2f1f0b);this['v'][_0x376c('0x10')](_0x4cfc61)||(this['I'][_0x376c('0x10')](_0x4cfc61)||this['A'][_0x376c('0x5')](_0x4cfc61)||(this['I'][_0x376c('0xa')](_0x4cfc61),this['A'][_0x376c('0xa')]({'stackId':_0x4cfc61['id'],'view':_0x4cfc61,'position':{'target':()=>_0x548354[_0x376c('0x12')](_0x4cfc61[_0x376c('0x3')])||_0x4cfc61[_0x376c('0x21')]}})),_0x4498bb&&this['A'][_0x376c('0x0')](_0x4cfc61['id']));}['C'](_0x47f4d1){this['I'][_0x376c('0x10')](_0x47f4d1)&&this['A'][_0x376c('0x5')](_0x47f4d1)&&(this['I']['delete'](_0x47f4d1),this['A']['remove'](_0x47f4d1));}}