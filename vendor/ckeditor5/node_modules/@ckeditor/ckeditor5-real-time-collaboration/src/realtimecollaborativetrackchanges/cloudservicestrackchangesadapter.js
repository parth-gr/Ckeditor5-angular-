/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3e48=['then','TrackChangesService','editor','plugins','collaboration.channelId','resolve','update','getAll','connection','open','race','set','get','init','all','hasSuggestion','from','getUser','addUser','addSuggestionData','state','add','config','reconnect','requires','addToReconnectionStack','type','delete'];(function(_0x19a72b,_0x412443){const _0x181a2c=function(_0x2057dc){while(--_0x2057dc){_0x19a72b['push'](_0x19a72b['shift']());}};_0x181a2c(++_0x412443);}(_0x3e48,0x1ca));const _0x2c50=function(_0x19a72b,_0x412443){_0x19a72b=_0x19a72b-0x0;let _0x181a2c=_0x3e48[_0x19a72b];return _0x181a2c;};import _0x1dabb2 from'@ckeditor/ckeditor5-core/src/plugin';import _0x3775d9 from'../../../ckeditor-cloud-services-collaboration/src/track-changes/trackchangesservice';import _0x3203cc from'../realtimecollaborativeediting/websocketgateway';import _0x57e4f7 from'../realtimecollaborativecomments/cloudservicescommentsadapter';import _0x5dc552 from'@ckeditor/ckeditor5-track-changes/src/trackchangesediting';import _0xc7daa5 from'@ckeditor/ckeditor-cloud-services-collaboration/src/users/user';import _0x4429ea from'@ckeditor/ckeditor5-collaboration-core/src/users';export default class ee extends _0x1dabb2{static get[_0x2c50('0xe')](){return[_0x57e4f7,_0x5dc552,_0x3203cc];}constructor(_0x12c6dd){super(_0x12c6dd),this['tt']=new Map();}[_0x2c50('0x3')](){const _0x2df130=this[_0x2c50('0x14')][_0x2c50('0x15')][_0x2c50('0x2')](_0x3203cc),_0x4757b2=this[_0x2c50('0x14')][_0x2c50('0x15')][_0x2c50('0x2')](_0x5dc552),_0x4b2b50=this[_0x2c50('0x14')][_0x2c50('0xc')][_0x2c50('0x2')](_0x2c50('0x16'));return _0x2df130[_0x2c50('0xf')](this),this['ot']=new ee[(_0x2c50('0x13'))](_0x4b2b50,_0x2df130[_0x2c50('0x1a')]),_0x4757b2['adapter']={'getSuggestion':async _0x1cb2bb=>{const _0x3c1a63=await this['ot'][_0x2c50('0x2')](_0x1cb2bb);return await this['m']([_0x3c1a63]),_0x3c1a63;},'addSuggestion':async({id:_0x267634,type:_0x14ad10,data:_0x1df825,originalSuggestionId:_0x4b6af8})=>{const _0x29c887={'id':_0x267634,'type':_0x14ad10,'data':_0x1df825,'originalSuggestionId':_0x4b6af8},_0x4ff836=new Promise(_0x1c80b0=>{this['tt'][_0x2c50('0x1')](_0x267634,{'resolve':_0x1c80b0,'suggestionData':_0x29c887});}),_0x36895f=await Promise[_0x2c50('0x0')]([this['ot'][_0x2c50('0xb')](_0x267634,_0x14ad10,_0x1df825,_0x4b6af8),_0x4ff836]);return this['tt'][_0x2c50('0x11')](_0x267634),_0x36895f;},'updateSuggestion':(_0x41f779,_0x55d5d2)=>_0x2c50('0x1b')!==_0x55d5d2[_0x2c50('0xa')]?this['ot'][_0x2c50('0x18')](_0x41f779,_0x55d5d2):Promise[_0x2c50('0x17')]()},this['ot'][_0x2c50('0x19')]()[_0x2c50('0x12')](_0x480911=>this['m'](_0x480911)[_0x2c50('0x12')](()=>{for(const _0x328d89 of _0x480911)_0x4757b2[_0x2c50('0x9')](_0x328d89);}));}async[_0x2c50('0xd')](){const _0x4e93db=this[_0x2c50('0x14')][_0x2c50('0x15')][_0x2c50('0x2')](_0x5dc552),_0x360018=await this['ot'][_0x2c50('0x19')]();for(const {suggestionData:_0xff5461,resolve:_0x5a8816}of this['tt']['values']()){let _0x516cc4=_0x360018['find'](_0x50b225=>_0x50b225['id']===_0xff5461['id']);_0x516cc4||(_0x516cc4=await this['ot'][_0x2c50('0xb')](_0xff5461['id'],_0xff5461[_0x2c50('0x10')],_0xff5461['data'],_0xff5461['originalSuggestionId'])),_0x5a8816(_0x516cc4);}for(const _0x53a799 of _0x360018)_0x4e93db[_0x2c50('0x5')](_0x53a799['id'])||_0x4e93db[_0x2c50('0x9')](_0x53a799);}['m'](_0x3fb550){const _0x492867=this[_0x2c50('0x14')][_0x2c50('0x15')][_0x2c50('0x2')](_0x4429ea),{connection:_0xc388db}=this[_0x2c50('0x14')][_0x2c50('0x15')][_0x2c50('0x2')](_0x3203cc),_0x3cd2fb=new Set();for(const {authorId:_0x6ce276}of _0x3fb550)_0x492867[_0x2c50('0x7')](_0x6ce276)||_0x3cd2fb[_0x2c50('0xb')](_0x6ce276);return Promise[_0x2c50('0x4')](Array[_0x2c50('0x6')](_0x3cd2fb)['map'](_0x554421=>_0xc7daa5[_0x2c50('0x2')](_0xc388db,_0x554421)[_0x2c50('0x12')](_0x1fe51b=>{_0x492867[_0x2c50('0x7')](_0x554421)||_0x492867[_0x2c50('0x8')](_0x1fe51b);})));}}ee[_0x2c50('0x13')]=_0x3775d9;